<header class="clearfix">
    <div class="left" >
        <span class="state {{connectionStatus}}">{{ connectionStatus }}</span>
        <span ng-show="connectionStatus == 'disconnected'">Offline since {{ connectionChangedAt | date:'shortTime' }}</span>
    </div>

    <div class="right">
        <a ng-click="queue.purge()" ng-hide="queue.messages.length === 0 || connectionStatus !== 'connected'" ng-href="">Clear All</a>
        <a ng-click="settingsVisibility = (!settingsVisibility)" ng-class="{ active: settingsVisibility }" ng-hide="browserNotification.state == 'unavailable'">Settings</a>
        <a ng-href="/logout">Log out</a>
    </div>

    <ul id="app-settings" ng-show="settingsVisibility">
        <li ng-hide="browserNotification.state == 'unavailable'">
            Browser notifications are <a ng-click="browserNotification.enable()" ng-href="">{{ browserNotification.state}}</a>.
        </li>
    </ul>
</header>

<main>
    <p class="app-message fade-in" ng-if="queue.pristine === true">Checking for messages...</p>
    <p class="app-message fade-in" ng-if="queue.pristine === false && queue.messages.length === 0">There are no new messages.</p>

    <article class="message {{ message.badge }}" ng-class="{extended: message.extended}" ng-repeat="message in queue.messages" ng-swipe-left="message.extended = true" ng-swipe-right="message.extended = false">
        <div class="options standard-options">
            <a ng-href="" ng-hide="connectionStatus !== 'connected'" ng-click="queue.clear(message.publicId)"><span>Clear</span></a>
        </div>

        <div class="badge"></div>

        <h1 ng-show="message.title">
            <a ng-if="message.url" ng-href="{{ message.url }}" target="_blank">{{ message.title }}</a>
            <span ng-if="!message.url">{{ message.title }}</span>
        </h1>
        <time datetime="{{ message.received | date:'yyyy-MM-ddTHH:mmZ' }}">
            {{ message.received | date:'h:mm a' }}
            {{ message.received | reldate | date: 'EEEE MMMM d' }}
        </time>
        <p ng-show="message.body" ng-bind-html="message.body"></p>
    </article>
</main>
